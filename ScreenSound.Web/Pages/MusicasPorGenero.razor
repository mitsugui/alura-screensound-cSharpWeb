@page "/MusicasPorGenero"
@page "/MusicasPorGenero/{NomeGenero}"
@inject MusicasApi Api

<PageTitle>Procurar Músicas</PageTitle>

<MudTextField Placeholder="Pesquisar gênero..."
              @bind-Value="NomeGenero" />

<MudButton Variant="Variant.Filled"
		   @onclick="PesquisarAsync"
           Color="Color.Primary"
           Class="m1-auto">
	Pesquisar
</MudButton>


@if (_musicas is not null)
{
	<MudGrid>
		@foreach (var musica in _musicas)
		{
			<MudItem xs="3">
				<CardMusica Musica="musica" />
			</MudItem>
		}
	</MudGrid>
}

@code {
	private ICollection<MusicaResponse>? _musicas;

	[Parameter]
	public string? NomeGenero { get; set; }

	protected override async Task OnInitializedAsync()
	{
		if (NomeGenero == null) return;

		await PesquisarAsync();
	}

	private async Task PesquisarAsync()
	{
		_musicas = NomeGenero is not null
			? await Api.GetMusicasPorGeneroAsync(NomeGenero)
			: null;
	}
}